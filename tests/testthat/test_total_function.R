context("Input and output of total.function()")
library("t.mix")

test_that("Inputs are correctly checked", {
  expect_error(total.function())
  expect_error(total.function(NULL))
  expect_error(total.function("a"))
  expect_error(total.function(matrix()))
  expect_error(total.function(matrix(-1)))
  expect_error(total.function(c(-1,0)))
  expect_error(total.function(c(122,0,44,999,0,123,8),NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8),"a"))
  expect_error(total.function(c(122,0,44,999,0,123,8),c(-2,-2)))
  expect_error(total.function(c(122,0,44,999,0,123,8),2))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12, NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12, "a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12, -4))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12, 1, "a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12, 1, 6:13))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12, 1, 13:19))
  expect_error(total.function(c(122,0,44,999,0,123,8),6:12, 1, NULL, NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, "a"))
  expect_error(total.function(c(122,0,44,999,0,123,8),1, NULL, F,NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,"a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,10000))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1, NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,"a" ))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,10000))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,"a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2, 0.8,"a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,"a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,-1))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,"a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,NULL))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,"a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"a"))
  expect_error(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,1))
})

test_that("Output has correct format", {
  expect_true(dim(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"Nelder-Mead")$parameters)[2]==4)
  expect_true(dim(total.function(c(122,0,44,999,0,123,8), 6:12,3, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"Nelder-Mead")$parameters)[1]==3)
  expect_true(is.numeric(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"Nelder-Mead")$parameters))
  expect_true(is.numeric(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"Nelder-Mead")$ECOFF))
  expect_true(is.numeric(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"Nelder-Mead")$AIC))
  expect_true(is.numeric(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"Nelder-Mead")$BIC))
  expect_true(is.numeric(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"Nelder-Mead")$log_likelihood))
  expect_true(is.numeric(total.function(c(122,0,44,999,0,123,8), 6:12,1, NULL, F,0.1,0.2,0.8,0.7,2,1000,10^-3,"Nelder-Mead")$EM_iterations))
})


