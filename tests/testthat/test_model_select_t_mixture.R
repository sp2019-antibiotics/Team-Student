context("Input and output of model.select.t.mixture()")
library("t.mix")

test_that("Inputs are correctly checked", {
  expect_error(model.select.t.mixture())
  expect_error(model.select.t.mixture(NULL))
  expect_error(model.select.t.mixture("a"))
  expect_error(model.select.t.mixture(matrix()))
  expect_error(model.select.t.mixture(matrix(-1)))
  expect_error(model.select.t.mixture(c(-1,0)))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8),NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8),"a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8),c(-2,-2)))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8),2))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, -4))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, NULL))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, "a"))
  expect_error(model.select.t.mixture(c(122,0,44,999,0,123,8), 6:12, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, 0.001, "a"))
})

test_that("Output has correct format", {
  expect_true(dim(model.select.t.mixture(c(122,0,44,999,0,123,8,8,0,20), 6:15, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, 0.001, "Nelder-Mead")$parameters)[2]==4)
  expect_true(dim(model.select.t.mixture(c(122,0,44,999,0,123,8,8,0,20), 6:15, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, 0.001, "Nelder-Mead")$parameters)[1]==3)
  expect_true(is.numeric(model.select.t.mixture(c(122,0,44,999,0,123,8,8,0,20), 6:15, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, 0.001, "Nelder-Mead")$AIC))
  expect_true(is.numeric(model.select.t.mixture(c(122,0,44,999,0,123,8,8,0,20), 6:15, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, 0.001, "Nelder-Mead")$BIC))
  expect_true(is.numeric(model.select.t.mixture(c(122,0,44,999,0,123,8,8,0,20), 6:15, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, 0.001, "Nelder-Mead")$log_likelihood))
  expect_true(is.numeric(model.select.t.mixture(c(122,0,44,999,0,123,8,8,0,20), 6:15, 3, "AIC", NULL, F, 0.4, 0.2, 0.05, NULL, 2, 1000, 0.001, "Nelder-Mead")$EM_iterations))
})



